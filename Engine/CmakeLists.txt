cmake_minimum_required(VERSION 3.22 FATAL_ERROR)
project(AL_OD_Runtime VERSION 0.2 LANGUAGES C CXX)

set(CMAKE_C_STANDARD 20)
set(CMAKE_C_STANDARD_REQUIRED ON)
set(CMAKE_C_EXTENSIONS OFF)

set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

#------------------------------------------------------------------------#
# Project Shortcut-variables
#------------------------------------------------------------------------#

set(LIBRARY_SRCS
    "${CMAKE_CURRENT_SOURCE_DIR}/Source/Engine.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Source/Runtime_variables.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Source/Win32_properties.cpp"
)

set(LIBRARY_HDRS
    "${CMAKE_CURRENT_SOURCE_DIR}/Include/Engine.h"
)

#------------------------------------------------------------------------#
# Project Shortcut-variables
#------------------------------------------------------------------------#


#------------------------------------------------------------------------#
# Project Build-Helper function
#------------------------------------------------------------------------#

build_and_export_library(${PROJECT_NAME}
  OUTPUT_DIR                    Engine
  BUILD_DESTINATION_PATH        ${global_build_dir}
  VERSION                       0.1
  EXPORT_FLAG                   ENGINE_EXPORTS 
  SOURCES                       ${LIBRARY_SRCS}
  HEADERS                       ${LIBRARY_HDRS}
  LINK_LIBS                     d3d11 dxgi d3dcompiler dwmapi
  PUBLIC_INCLUDES               ${CMAKE_CURRENT_SOURCE_DIR}/Include
  PRIVATE_INCLUDES              ${CMAKE_CURRENT_SOURCE_DIR}/Internal
)

#------------------------------------------------------------------------#
# Project Build-Helper function
#------------------------------------------------------------------------#

# Copy DLL (or .so/.dylib) to some folder after build
copy_library_post_build(${PROJECT_NAME} "${Client_Path}")